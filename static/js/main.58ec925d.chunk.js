(this.webpackJsonphyperworkshop=this.webpackJsonphyperworkshop||[]).push([[0],[,,,,,,,,,,,function(e,t,n){e.exports=n(34)},,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,,,,function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"heart",(function(){return S})),n.d(a,"heartFilled",(function(){return I})),n.d(a,"arrowRight",(function(){return B}));var r=n(6),c=n(0),l=n.n(c),i=n(10),o=n.n(i),s=n(2),u=n(1),m=n.n(u);n(16);function p(e){var t=e.appName,n=e.className;return l.a.createElement("h1",{className:m()("Logotype",n)},t)}n(17);function f(e){var t=e.appName,n=e.children,a=e.className;return l.a.createElement("header",{className:m()("Header",a)},l.a.createElement(p,{className:"Header-logotype",appName:t}),l.a.createElement("div",{className:"Header-content"},n))}var d=n(4);n(18);function h(e){var t=e.className,n=e.children,a=e.plain,r=e.onClick,c=e.to,i=e.disabled,o=e.theme,s=c?"a":"button";return l.a.createElement(s,{disabled:i,href:c||null,onClick:i?null:r,className:m()("Button",t,Object(d.a)({"Button--plain":a},"theme-".concat(o),o))},l.a.createElement("span",{className:m()("Button-text")},n))}var v=n(5);n(19);function g(e){var t=e.className,n=e.url,a=e.src,c=e.srcSet,i=e.width,o=e.height,s=e.alt,u=e.filter,p=e.cover,f=Object(v.a)(e,["className","url","src","srcSet","width","height","alt","filter","cover"]),d=a||n;if(d.match(/cloudinary/)){var h=[];u&&h.push(u),i&&h.push("w_".concat(i)),o&&h.push("h_".concat(o)),d=d.replace(/upload\//,"upload/".concat(h.join(","),"/"))}return l.a.createElement("figure",{className:m()("Image",t,{"Image--cover":p})},l.a.createElement("img",Object.assign({className:"Image-image",src:d},Object(r.a)({},f,{alt:s,srcSet:c,width:i,height:o}))))}n(20);function b(e){var t=e.comment,n=e.user.username,a=e.className;return l.a.createElement("div",{className:m()("Comment",a)},l.a.createElement("p",{className:"Comment-comment"},t),l.a.createElement("span",{className:"Comment-user"},n))}var E=n(8),k=n.n(E);function O(e){var t=e.className,n=e.children,a=Object(v.a)(e,["className","children"]),r=Object(c.useRef)();return l.a.createElement("form",Object.assign({ref:r,className:m()("Form",t)},a,{onChange:function(e){var t=k()(r.current,{hash:!0,empty:!1});a.onChange&&a.onChange(e,t)},onSubmit:function(e){var t=k()(r.current,{hash:!0,empty:!1});a.onSubmit&&(e.preventDefault(),a.onSubmit(e,t))}}),n)}n(21);function y(e){var t=e.className,n=e.inputClassName,a=e.defaultValue,r=e.value,i=e.onChange,o=Object(v.a)(e,["className","inputClassName","defaultValue","value","onChange"]),u=Object(c.useState)(a),p=Object(s.a)(u,2),f=p[0],d=p[1],h=Object(c.useState)(r),g=Object(s.a)(h,2),b=g[0],E=g[1];return b!==r&&(d(r),E(r)),l.a.createElement("div",{className:m()("Textarea",t)},l.a.createElement("textarea",Object.assign({className:m()("Textarea-input",n),onChange:function(e){var t=e.target.value;d(t),i&&i(e,t)},value:f},o)),l.a.createElement("pre",{className:"Textarea-pre"},f))}n(22);function N(e){var t=e.onComment,n=e.className,a=Object(c.useState)(),r=Object(s.a)(a,2),i=r[0],o=r[1];return l.a.createElement(O,{className:m()("CommentForm",n),onSubmit:function(){t(i),o("")}},l.a.createElement(y,{name:"comment",className:"CommentForm-textarea",inputClassName:"CommentForm-input",placeholder:"Write a comment...",value:i,onChange:function(e,t){return o(t)}}),i?l.a.createElement(h,{plain:!0,className:"CommentForm-submit"},"Send"):null)}function j(){return(j=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function x(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},c=Object.keys(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var w=l.a.createElement("path",{fill:"none",strokeWidth:2,strokeMiterlimit:10,d:"M1,21c0,20,31,38,31,38s31-18,31-38 c0-8.285-6-16-15-16c-8.285,0-16,5.715-16,14c0-8.285-7.715-14-16-14C7,5,1,12.715,1,21z"}),C=function(e){var t=e.svgRef,n=e.title,a=x(e,["svgRef","title"]);return l.a.createElement("svg",j({id:"Layer_1",x:"0px",y:"0px",width:"64px",height:"64px",viewBox:"0 0 64 64",enableBackground:"new 0 0 64 64",xmlSpace:"preserve",ref:t},a),n?l.a.createElement("title",null,n):null,w)},S=l.a.forwardRef((function(e,t){return l.a.createElement(C,j({svgRef:t},e))}));n.p;function _(){return(_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function P(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},c=Object.keys(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var L=l.a.createElement("path",{d:"M401.788,74.476c-63.492-82.432-188.446-33.792-188.446,49.92 c0-83.712-124.962-132.356-188.463-49.92c-65.63,85.222-0.943,234.509,188.459,320.265 C402.731,308.985,467.418,159.698,401.788,74.476z"}),F=function(e){var t=e.svgRef,n=e.title,a=P(e,["svgRef","title"]);return l.a.createElement("svg",_({id:"Layer_1",x:"0px",y:"0px",viewBox:"0 0 426.668 426.668",style:{enableBackground:"new 0 0 426.668 426.668"},xmlSpace:"preserve",ref:t},a),n?l.a.createElement("title",null,n):null,L)},I=l.a.forwardRef((function(e,t){return l.a.createElement(F,_({svgRef:t},e))}));n.p;function R(){return(R=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function z(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},c=Object.keys(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var T=l.a.createElement("polyline",{fill:"none",strokeWidth:2,strokeLinejoin:"bevel",strokeMiterlimit:10,points:"27,15 44,32 27,49  "}),U=l.a.createElement("circle",{fill:"none",strokeWidth:2,strokeMiterlimit:10,cx:32,cy:32,r:30.999}),A=function(e){var t=e.svgRef,n=e.title,a=z(e,["svgRef","title"]);return l.a.createElement("svg",R({id:"Layer_1",x:"0px",y:"0px",width:"64px",height:"64px",viewBox:"0 0 64 64",enableBackground:"new 0 0 64 64",xmlSpace:"preserve",ref:t},a),n?l.a.createElement("title",null,n):null,T,U)},B=l.a.forwardRef((function(e,t){return l.a.createElement(A,R({svgRef:t},e))}));n.p,n(23);function M(e){var t,n=e.type,r=e.className,c=e.size,i=e.color,o=e.text,s=a[n];return s?l.a.createElement("div",{className:m()("Icon",r,(t={},Object(d.a)(t,"color-".concat(i),i),Object(d.a)(t,"Icon--".concat(c),c),t)),title:o},l.a.createElement(s,null)):null}n(24);function $(e){e.className;var t=e.user.username,n=e.image,a=e.filter,r=e.description,c=e.comments,i=void 0===c?[]:c,o=e.likes,s=void 0===o?[]:o,u=e.onComment,p=e.onLike,f=e.onUnlike;return l.a.createElement("section",{className:m()("Post",m.a)},l.a.createElement("header",{className:"Post-header"},l.a.createElement("span",{className:"Post-user"},t)),l.a.createElement("div",{className:"Post-content"},n?l.a.createElement(g,Object.assign({key:n.id},n,{filter:a,url:n.url,width:700,className:"Post-image"})):null),l.a.createElement("footer",{className:"Post-footer"},l.a.createElement("div",{className:"Post-likes"},l.a.createElement("span",{className:"Post-likeCount",title:s.map((function(e){return e.user.username})).join(", ")},"".concat(s.length," likes")),p?l.a.createElement(h,{onClick:p,plain:!0},l.a.createElement(M,{size:"large",type:"heart",text:"Like"})):f?l.a.createElement(h,{onClick:f,plain:!0},l.a.createElement(M,{size:"large",type:"heartFilled",text:"Unlike"})):null),r?l.a.createElement("p",{className:"Post-description"},r):null,i.length?l.a.createElement("div",{className:"Post-comments"},i.map((function(e){return l.a.createElement(b,Object.assign({key:e.id},e,{className:"Post-comment"}))}))):null,u?l.a.createElement(N,{onComment:u,className:"Post-commentForm"}):null))}var q=function(e,t,n){return new Promise((function(a,r){var c=new XMLHttpRequest;c.open("POST",t),c.setRequestHeader("Authorization","Bearer ".concat(n)),c.responseType="json",c.addEventListener("load",(function(){return a(c.response)})),c.addEventListener("error",r),c.send(e)}))};n(25);function H(e){var t=e.name,n=void 0===t?"files":t,a=e.className,r=(e.label,e.onChange),i=e.onUpload,o=e.multiple,u=e.url,p=e.token,f=Object(c.useRef)(),d=Object(c.useState)(),h=Object(s.a)(d,2),v=h[0],g=h[1];return l.a.createElement(O,{className:m()("FileUploader",a,{"FileUpload--loading":v}),encType:"multipart/form-data",onChange:function(e){var t=new FormData(e.currentTarget);u&&f.current.files.length&&(g(!0),q(t,u,p).then((function(e){g(!1),i&&i(e)}))),r&&r(e,f.current.files)}},l.a.createElement("div",{className:"FileUploader-inputWrapper"},l.a.createElement("input",{accept:"image/*",ref:f,className:"FileUploader-input",type:"file",multiple:o,name:n})))}n(26);function W(e){var t=e.children,n=e.className,a=e.onClose;return l.a.createElement("div",{className:m()("Modal",n)},l.a.createElement("div",{className:"Modal-overlay",onClick:a}),l.a.createElement("div",{className:"Modal-box"},t))}n(27);function J(e){var t=e.className,n=e.onSubmit,a=e.onChange,r=(e.children,e.image),i=Object(c.useState)(),o=Object(s.a)(i,2),u=o[0],p=o[1];return l.a.createElement(O,{onSubmit:n,onChange:a,className:m()("CreatePostForm",t)},l.a.createElement("input",{type:"hidden",name:"image",value:r.id}),l.a.createElement(g,{url:r.url,width:600,filter:u}),u?l.a.createElement("input",{type:"hidden",name:"filter",value:u}):null,l.a.createElement("div",{className:"CreatePostForm-filters"},[{text:"Al dente",filter:"e_art:al_dente"},{text:"Athena",filter:"e_art:athena"},{text:"audrey",filter:"e_art:audrey"},{text:"aurora",filter:"e_art:aurora"},{text:"daguerre",filter:"e_art:daguerre"},{text:"eucalyptus",filter:"e_art:eucalyptus"},{text:"fes",filter:"e_art:fes"},{text:"frost",filter:"e_art:frost"},{text:"hairspray",filter:"e_art:hairspray"},{text:"hokusai",filter:"e_art:hokusai"},{text:"incognito",filter:"e_art:incognito"},{text:"linen",filter:"e_art:linen"},{text:"peacock",filter:"e_art:peacock"},{text:"primavera",filter:"e_art:primavera"},{text:"quartz",filter:"e_art:quartz"},{text:"red_rock",filter:"e_art:red_rock"},{text:"refresh",filter:"e_art:refresh"},{text:"sizzle",filter:"e_art:sizzle"},{text:"sonnet",filter:"e_art:sonnet"},{text:"ukulele",filter:"e_art:ukulele"},{text:"zorro",filter:"e_art:zorro"},{text:"oil paint",filter:"e_oil_paint:70"},{text:"cartoon",filter:"e_cartoonify:70"},{text:"vector",filter:"e_vectorize:70"}].map((function(e){var t=e.text,n=e.filter;return l.a.createElement("div",{className:"CreatePostForm-filter"},l.a.createElement(g,{cover:!0,url:r.url,className:"CreatePostForm-filterImage",width:100,filter:n,onClick:function(){p(n)}}),t)}))),l.a.createElement(y,{className:"CreatePostForm-description",placeholder:"Write a description",name:"description"}),l.a.createElement(h,null,"Create post"))}var D=n(3);n(28),n(29);function V(e){var t=e.isAuthenticated,n=e.apiUrl,a=e.token,r=Object(D.d)('\n    query getPosts {\n      posts(sort:"created_at:desc") {\n        id\n        user {\n          id\n          username\n        }\n        filter\n        image {\n          id\n          url\n        }\n        description\n        likes {\n          id\n          user {\n            id\n            username\n          }\n        }\n        comments {\n          id\n          comment\n          user {\n            id\n            username\n          }\n        }\n      }\n    }\n  '),i=r.loading,o=r.data,u=(o=void 0===o?{}:o).posts,m=void 0===u?[]:u,p=r.refetch,d=Object(D.d)("\n    query me {\n      me {\n        id\n        username\n        email\n      }\n    }\n  ").data,v=(d=void 0===d?{}:d).me,g=Object(D.c)("\n    mutation createLike($input: createLikeInput) {\n      createLike(input: $input) {\n        like {\n          id\n        }\n      }\n    }\n  "),b=Object(s.a)(g,1)[0],E=Object(D.c)("\n    mutation deleteLike($input: deleteLikeInput) {\n      deleteLike(input: $input) {\n        like {\n          id\n        }\n      }\n    }\n  "),k=Object(s.a)(E,1)[0],O=Object(D.c)("\n    mutation createComment($input: createCommentInput) {\n      createComment(input: $input) {\n        comment {\n          id\n        }\n      }\n    }\n  "),y=Object(s.a)(O,1)[0],N=Object(D.c)("\n    mutation createPost($input: createPostInput) {\n      createPost(input: $input) {\n        post {\n          id\n        }\n      }\n    }\n  "),j=Object(s.a)(N,1)[0],x=Object(c.useState)(),w=Object(s.a)(x,2),C=w[0],S=w[1],_=Object(c.useState)(),P=Object(s.a)(_,2),L=P[0],F=P[1];return l.a.createElement("div",{className:"App layout-container layout-gutter"},l.a.createElement(f,{className:"App-header",appName:"Hypergram"},t&&v?l.a.createElement("div",null,v.username," ",l.a.createElement(h,{plain:!0,to:"/logout"},"Logout")):l.a.createElement(h,{onClick:function(){return S(!0)}},"Login")),l.a.createElement("div",{className:"App-content"},i&&!m?"Loading":m.map((function(e){return l.a.createElement($,Object.assign({key:e.id},e,{onLike:v&&!(e.likes||[]).find((function(e){var t=e.user;return String(t.id)===String(v.id)}))?function(){return b({variables:{input:{data:{post:e.id,user:v.id}}}}).then(p)}:null,onUnlike:v&&(e.likes||[]).find((function(e){var t=e.user;return String(t.id)===String(v.id)}))?function(){return k({variables:{input:{where:{id:e.likes.find((function(e){var t=e.user;return String(t.id)===String(v.id)})).id}}}}).then(p)}:null,onComment:v?function(t){return y({variables:{input:{data:{user:v.id,post:e.id,comment:t}}}}).then(p)}:null}))}))),v?l.a.createElement(H,{className:"App-uploader",onUpload:function(e){var t=Object(s.a)(e,1)[0];F(t)},url:"".concat(n,"/upload"),token:a}):null,L?l.a.createElement(W,{onClose:function(){return F(!1)}},l.a.createElement(J,{image:L,onSubmit:function(e,t){j({variables:{input:{data:{image:t.image,description:t.description,filter:t.filter,user:v.id}}}}).then((function(){F(!1),p()}))}})):null,C?l.a.createElement(W,{onClose:function(){return S(!1)}},l.a.createElement("h1",null,"Log in"),l.a.createElement(h,{to:"".concat(n,"/connect/facebook")},"Log in using Facebook"),l.a.createElement("hr",null),l.a.createElement(h,{to:"".concat(n,"/connect/google")},"Log in using Google")):null)}var G=n(7),X=n.n(G),K=n(31),Q=function(e){return localStorage.removeItem(e)},Y=function(e){return JSON.parse(localStorage.getItem(e))||null},Z=function(e,t){return localStorage.setItem(e,JSON.stringify(t))},ee={apiUrl:"https://hypergram.herokuapp.com",connect:function(e,t){var n,a;return X.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,X.a.awrap(fetch("".concat("https://hypergram.herokuapp.com","/auth/").concat(e,"/callback").concat(t)));case 2:return n=r.sent,r.next=5,X.a.awrap(n.json());case 5:if(!(a=r.sent)||!a.jwt){r.next=9;break}return ee.setToken(a.jwt),r.abrupt("return",a.jwt);case 9:return r.abrupt("return",!1);case 10:case"end":return r.stop()}}))},logout:function(){Q("accessToken")},getToken:function(){var e=Y("accessToken");if(!e)return!1;var t=K(e).exp;return t&&t>new Date/1e3&&e},setToken:function(e){Z("accessToken",e)},isAuthenticated:function(){return!!ee.getToken()}},te=ee,ne=window.location.pathname;"/logout"===ne&&(te.logout(),window.location.href="/");var ae=ne.match(/^\/auth\/callback\/(google|facebook)/);ae&&te.connect(ae[1],window.location.search).then((function(e){if(e)return window.location.href="/",!1}));var re=te.getToken(),ce=te.apiUrl,le=new D.b(Object(r.a)({url:"".concat(ce,"/graphql")},re?{headers:{Authorization:"Bearer ".concat(re)}}:{}));o.a.render(l.a.createElement((function(){return l.a.createElement(D.a.Provider,{value:le},l.a.createElement(V,{isAuthenticated:te.isAuthenticated(),token:re,apiUrl:ce}))}),null),document.getElementById("root"))}],[[11,1,2]]]);
//# sourceMappingURL=main.58ec925d.chunk.js.map